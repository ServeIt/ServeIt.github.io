<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Document | ServeIt</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Servit is based on Node.js, which uses an event-driven, non-blocking I/O model. So the game running on the server just need to handle serval events to transmit data to server and send to every client.">
<meta property="og:type" content="article">
<meta property="og:title" content="Document">
<meta property="og:url" content="http://serveit.github.io/2015/03/26/Document/">
<meta property="og:site_name" content="ServeIt">
<meta property="og:description" content="Servit is based on Node.js, which uses an event-driven, non-blocking I/O model. So the game running on the server just need to handle serval events to transmit data to server and send to every client.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Document">
<meta name="twitter:description" content="Servit is based on Node.js, which uses an event-driven, non-blocking I/O model. So the game running on the server just need to handle serval events to transmit data to server and send to every client.">

  
  <link href="/my.ico" rel="icon" type="image/x-ico">

  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
<hr id="topline">
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">ServeIt</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/">Games</a></li><li><a href="/archives">Docs</a></li><li><a href="https://groups.google.com/forum/?hl=zh-CN#!forum/serveit">Forums</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://serveit.github.io"></form>
	</div>
</header>
   	
	    <div class="sidenav">
	    	<h1> Docs </h1>
			 
				
		      		
		               	 <p><a href="/2015/03/26/GetGames/">- Get Games</a></p>
		            
		         
		     
				
		      		
		               	 <p><a href="/2015/03/26/Document/">- Document</a></p>
		            
		         
		     
				
		      		
		               	 <p><a href="/2015/03/26/Usage/">- Usage</a></p>
		            
		         
		     	
	    </div>
		<div id="main">
	      
<article id="post-Document" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2015/03/26/Document/" class="article-date">
  <time datetime="2015-03-26T05:25:20.000Z" itemprop="datePublished">Mar 26 2015</time>
</a>
		</span>
		<div class="commentscount">
			
		</div>
	</footer>
	<header class="entry-header">
		
  
    <h1 class="article-title entry-title" itemprop="name">
      Document
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Servit is based on <a href="https://nodejs.org" target="_blank" rel="external">Node.js</a>, which uses an event-driven, non-blocking I/O model. So the game running on the server just need to handle serval events to transmit data to server and send to every client.</p>
<p>The <code>Client</code> class is used as the client of the game and transmitting data between server and client. You can simply create a new connection by creating an instance of <code>Client</code>.</p>
<h3 id="Properties">Properties</h3>
<p>Serval properties are used for storing the server and game data in the client-side. Besides, you could also create other properties for storing custom data in your client.</p>
<h3 id="gameState_:_number">gameState : number</h3>
<p>The state of  the game. It defined the current state of the game and the states could be customs by user. Here is some examples.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">game.states = {</div><div class="line">	<span class="string">"startState"</span> : 0,</div><div class="line">	<span class="string">"waitState"</span>  : 1,</div><div class="line">	<span class="string">"mapState"</span> 	 : 2,</div><div class="line">	<span class="string">"gameState"</span>  : 3</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="clientInfo_:_object">clientInfo : object</h3>
<p>The information about the client, which could be used by the server.</p>
<h3 id="socket_:_socket-io#http">socket : socket.io#http</h3>
<p>The connection between client and server for transmitting data.</p>
<h3 id="clients_:_object">clients : object</h3>
<p>The information of all the online clients. The property name is the <code>clientID</code> and the value is <code>clientInfo</code>.</p>
<h3 id="clientIP_:_string">clientIP : string</h3>
<p>the IP address of the client.</p>
<h3 id="host_:_string">host : string</h3>
<p>The IP address of the host client.</p>
<h3 id="hostRight_:_string">hostRight : string</h3>
<p>The special right of the host client.</p>
<h3 id="Events">Events</h3>
<p>The client need to listen to these events for receiving data from the server. Also, some of the events need to be emitted to server from clients.</p>
<h4 id="Client_events">Client events</h4>
<h5 id="getConnected">getConnected</h5>
<p>Once the client is connected to the server, the server would emit <code>getConnected</code> event to this client. Here is the structure of message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"accept"</span>: <span class="built_in">boolean</span>, <span class="comment">// whether the client is accepted by the server</span></div><div class="line"><span class="string">"totalClients"</span>: <span class="built_in">number</span>, <span class="comment">// the online client number</span></div><div class="line"><span class="string">"host"</span>: <span class="built_in">string</span>, <span class="comment">// the IP of the host</span></div><div class="line"><span class="string">"clientID"</span>: <span class="built_in">string</span>, <span class="comment">// the ID of the client</span></div><div class="line"><span class="string">"clientIP"</span>: <span class="built_in">string</span>, <span class="comment">// the IP of the client</span></div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="accept">accept</h4>
<p>This event is emitted by client after it receive the <code>getConnected</code> from server. It would send the information of it self to the server.</p>
<h4 id="changeState">changeState</h4>
<p>The client could change the state of the game by emit <code>changeState</code> to server. Once the server received the event and the data, it would change the state of the game and emit <code>changeState</code> event to every clients. Here is the structure of the message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"state"</span>: <span class="built_in">number</span> <span class="comment">// the state of  the game</span></div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="gameOperate">gameOperate</h4>
<p>The client emit <code>gameOperate</code> event for interact with other client. The data about the action and some custom data of the action would be sent to the server. The server then emit the action to all the client. Here is the structure of the message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"action"</span>: string, // the name of the action, which would be used as event name to emit to all the client</div><div class="line"><span class="keyword">...</span> // some data about this action</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="getInfo">getInfo</h3>
<p>Client could emit this event to get the information of the server and the client. Here is the structure of the message that the server send back to client:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"accept"</span>: <span class="built_in">boolean</span>, <span class="comment">// whether the client is accepted by the server</span></div><div class="line"><span class="string">"totalClients"</span>: <span class="built_in">number</span>, <span class="comment">// the online client number</span></div><div class="line"><span class="string">"host"</span>: <span class="built_in">string</span>, <span class="comment">// the IP of the host</span></div><div class="line"><span class="string">"clientID"</span>: <span class="built_in">string</span>, <span class="comment">// the ID of the client</span></div><div class="line"><span class="string">"clientIP"</span>: <span class="built_in">string</span>, <span class="comment">// the IP of the client</span></div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="update">update</h4>
<p><code>update</code> event is emitted by client to server for updating the client information and announce all other clients. Here is the structure of the message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"clientID"</span>: <span class="keyword">string</span>, <span class="comment">// the ID of the client</span></div><div class="line"><span class="string">"obj"</span>: msg.obj,</div><div class="line"><span class="string">"clients"</span>: clients</div><div class="line">};</div></pre></td></tr></table></figure>

<h4 id="serverOpen,_serverClose">serverOpen, serverClose</h4>
<p>These two events could be emitted by host client to control the state of server. <code>serverClose</code> would stop the server from accepting new client and <code>serverOpen</code> would reopen it.</p>
<h4 id="disconnect">disconnect</h4>
<p><code>disconnect</code> is emitted once the client stop the connection between server. The server would remove the client information from <code>clients</code> and announce all the client about this.</p>
<h4 id="accepted">accepted</h4>
<p>The server listen to <code>accept</code> event and once received, the server would save the client information in <code>clients</code>and emit the <code>accepted</code>event to client . Here is the structure of the message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"clients"</span>: <span class="keyword">object</span> <span class="comment">// the information of all the online clients </span></div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="disconnection">disconnection</h4>
<p><code>disconnection</code> is emitted after the server receive the <code>disconnect</code> event. This would send the disconnected client information to all the other clients. If the disconnected client is the last client of the server, it would reset the server. Here is the structure of the message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line"><span class="string">"host"</span>: <span class="keyword">string</span>, <span class="comment">// the IP of the host</span></div><div class="line"><span class="string">"clientID"</span>: <span class="keyword">string</span>, <span class="comment">// the ID of the client</span></div><div class="line"><span class="string">"clientIP"</span>: <span class="keyword">string</span>, <span class="comment">// the IP of the client</span></div><div class="line">}</div></pre></td></tr></table></figure>


    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
    
<nav id="article-nav">
  
    <a href="/2015/03/26/Usage/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Usage
        
      </div>
    </a>
  
  
</nav>

  
</article>




	    </div>
	
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:serveit.github.io">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">ServeIt</a>
	</h1>
	<span class="copyright">
		&copy; 2015 Heros for hire<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>